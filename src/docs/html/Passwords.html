<HTML>
<HEAD>
<TITLE>MiG Documentation</TITLE>
<LINK REV="made" HREF="mailto:perl-bugs@sun.com">
</HEAD>

<BODY>

<!-- INDEX BEGIN -->
<!--

<UL>

	<LI><A HREF="#MIG_AND_PASSWORDS">MIG AND PASSWORDS</A>
	<UL>

		<LI><A HREF="#DISCLAIMER">DISCLAIMER</A>
		<LI><A HREF="#PASSWORD_PROTECTION">PASSWORD PROTECTION</A>
		<LI><A HREF="#CRYPT_FORMAT">CRYPT FORMAT</A>
		<LI><A HREF="#HOW_DO_I_PROTECT_THE_MAIN_LEVEL_">HOW DO I PROTECT THE MAIN LEVEL ('currDir=.') ?</A>
	</UL>

</UL>
-->
<!-- INDEX END -->

<P>




<P>
<HR>
<H1><A NAME="MIG_AND_PASSWORDS">MIG AND PASSWORDS</A></H1>
<P>




<P>
<HR>
<H2><A NAME="DISCLAIMER">DISCLAIMER</A></H2>
<P>
Note: this password scheme is not 100% secure! It's probably not even 95%
secure. Anyone who really wants to get to your images can get around this
protection by viewing the source of the page they are viewing and going to
image URLs directly and such. As such you shouldn't use this if you really
need your images to be protected. I hope to fix this security problem in a
future version of MiG but right now this is just the way it is.

<P>
<HR>
<H2><A NAME="PASSWORD_PROTECTION">PASSWORD PROTECTION</A></H2>
<P>
You may want to protect some folders from being viewed by the public. You
can do this by assigning usernames and passwords for access control to
particular folders.

<P>
To do this, add lines like this one to your <EM>mig.cfg</EM> file:

<P>
<PRE>    $protect['./Example_Gallery']['joe'] = 'IBDXWbkBirMfU';
</PRE>
<P>
The part in the first set of []'s is the directory. The second set of []'s
contains the username. The part in '' at the end is the password, in unix
<CODE>crypt()</CODE> format.

<P>
The directory name is the value of <CODE>currDir</CODE> as seen in any URL when you go to that folder. Some examples might be:

<P>
<PRE>    ./Example_Gallery
    ./People/Stephanie
    ./Trips/Europe
</PRE>
<P>
The password protection includes subfolders - so if you have a
<EM>Trips/Europe</EM> folder, and it contains many subfolders, they will also have the same
password protection properties.

<P>
Note that if you have a defined password policy for say
<EM>Trips/Europe/Belgium</EM>, it will override <EM>Trips</EM> or <EM>Trips/Europe</EM>. The rule is simple - the most specific definition wins. Or, one could say
the longest folder name wins.

<P>
A more complete example might be something like this:

<P>
<PRE>    $protect['./People/Stephanie']['dan']      = 'NI6kjeu0Bu5OA';
    $protect['./People/Stephanie']['kate']     = 'BSkfNxImwPHeQ';
    $protect['./People/Stephanie']['mom']      = 'IGSQpYrjm0znM';
</PRE>
<P>
<PRE>    $protect['./Trips/Europe/Belgium']['joe']  = 'NLmqM5pt3s6Xc';
    $protect['./Trips/Europe']['fig']          = 'RRElq4KBFcLhk';
</PRE>
<P>
It is important to use only the <CODE>currDir</CODE> string you want. Do not add a trailing slash, and do not omit any
characters at the end. Do not omit the leading <CODE>./</CODE> either.

<P>
So if you have <CODE>currDir=./People/Stephanie</CODE>, use <CODE>./People/Stephanie</CODE>
and not <CODE>People/Stephanie</CODE> or <CODE>./People/Stephanie/</CODE>.

<P>
<HR>
<H2><A NAME="CRYPT_FORMAT">CRYPT FORMAT</A></H2>
<P>
But wait! How do I generate unix <CODE>crypt()</CODE> format passwords?

<P>
Well, you can do it like this in PHP:

<P>
<PRE>    &lt;?php
        $pass = 'somepassword';
        $salt = 'Ai';
        print crypt($pass, $salt);
    ?&gt;
</PRE>
<P>
The salt is any two-character combination - it is used to seed the random
generation process, so to speak. Any two characters are good enough (but
you can't use ``:'' (colon) in a salt).

<P>
If you have access to Perl somewhere (most of us do), you can also find a
script in the contrib directory that will generate crypt format passwords
for you. Here's the URL to that script:

<P>
<PRE>    <A HREF="http://tangledhelix.com/software/mig/downloads/contrib/crypt">http://tangledhelix.com/software/mig/downloads/contrib/crypt</A>
</PRE>
<P>
<HR>
<H2><A NAME="HOW_DO_I_PROTECT_THE_MAIN_LEVEL_">HOW DO I PROTECT THE MAIN LEVEL ('currDir=.') ?</A></H2>
<P>
You could set up an <EM>.htaccess</EM> file in Apache, or the equivalent mechanism for your server, on your
gallery base directory.

<P>
If you want to do it using MiG's own password scheme, just set something
like this:

<P>
<PRE>    $protect['.']['kate'] = 'BSkfNxImwPHeQ';
</PRE>
</BODY>

</HTML>
