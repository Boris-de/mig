<HTML>
<HEAD>
<TITLE>MiG Documentation</TITLE>
<LINK REV="made" HREF="mailto:perl-bugs@sun.com">
</HEAD>

<BODY>

<!-- INDEX BEGIN -->
<!--

<UL>

	<LI><A HREF="#MIG_AND_THE_APACHE_SERVER">MIG AND THE APACHE SERVER</A>
	<UL>

		<LI><A HREF="#SECURITY_CONSIDERATIONS">SECURITY CONSIDERATIONS</A>
		<LI><A HREF="#USEFUL_REWRITE_IDEAS">USEFUL REWRITE IDEAS</A>
		<LI><A HREF="#IF_YOU_RE_USING_WINDOWS">IF YOU'RE USING WINDOWS</A>
	</UL>

</UL>
-->
<!-- INDEX END -->

<P>




<P>
<HR>
<H1><A NAME="MIG_AND_THE_APACHE_SERVER">MIG AND THE APACHE SERVER</A></H1>
<P>




<P>
<HR>
<H2><A NAME="SECURITY_CONSIDERATIONS">SECURITY CONSIDERATIONS</A></H2>
<P>
There are always security considerations when dealing with anonymous
external users accessing your system and data.

<P>
MiG itself mitigates these concerns where it can (for instance, a
<CODE>currDir</CODE> variable containing '..' causes MiG to panic and immediately exit), but it
can't do everything in itself.

<P>
The main thing MiG does to help with the security problem is that it never,
ever, writes anything to the disk. It only reads. This minimizes the amount
of damage potential that exists.

<P>
An example: MiG's PHP code can't control whether or not a web user fetches
your <EM>mig.cf</EM> or <EM>exif.inf</EM> files and so forth by simply using direct URLs. Users of Apache can use the
following in their configuration to get around this limitation:

<P>
<PRE>    &lt;Directory /path/to/your/mig/gallery&gt;
        # Protect against anyone trying to view mig.cf or mig.cfg
        &lt;Files ~ &quot;^mig.cfg?$&quot;&gt;
            order allow,deny
            deny from all
        &lt;/Files&gt;
        # Protect against anyone trying to view exif.inf files
        &lt;Files ~ &quot;^exif.inf$&quot;&gt;
            order allow,deny
            deny from all
        &lt;/Files&gt;
    &lt;/Directory&gt;
</PRE>
<P>
With these rules in place, someone can't for example go to a URL like:

<P>
<PRE>    <A HREF="http://tangledhelix.com/gallery/albums/Miscellaneous/mig.cf">http://tangledhelix.com/gallery/albums/Miscellaneous/mig.cf</A>
</PRE>
<P>
to see that file. It would be met with an access denial from the server.

<P>
(If you want to look at password protection ideas, see
<EM>docs/Passwords.txt</EM>.

<P>
<HR>
<H2><A NAME="USEFUL_REWRITE_IDEAS">USEFUL REWRITE IDEAS</A></H2>
<P>
You can use Apache's <CODE>mod_rewrite</CODE> module to make MiG URLs more simplified and easier to remember. Here's what
I do on my own site:

<P>
First, define simple shortcut names using the jumpMap (see
<EM>docs/Jump.txt</EM>).

<P>
Then, add a rule or two like this to <EM>httpd.conf</EM>:

<P>
<PRE>  RewriteRule ^/go/([^/]+)        /gallery/index.php?jump=$1    [R]
  RewriteRule ^/photo/([^/]+)     /gallery/index.php?jump=$1    [R]
</PRE>
<P>
That way you can use URLs like this:

<P>
<PRE>  <A HREF="http://tangledhelix.com/photo/kate">http://tangledhelix.com/photo/kate</A>
  <A HREF="http://tangledhelix.com/go/kate">http://tangledhelix.com/go/kate</A>
</PRE>
<P>
And it will automatically go to the right place. You can also do your own
custom shortcuts of course, like these:

<P>
<PRE>  RewriteRule ^/kate           /gallery/index.php?jump=kate     [R]
  RewriteRule ^/house          /gallery/index.php?jump=house    [R]
  RewriteRule ^/europe         /gallery/index.php?jump=europe   [R]
</PRE>
<P>
So you can have even simpler URLs if you want for certain galleries, like
<A HREF="http://tangledhelix.com/kate/">http://tangledhelix.com/kate/</A>

<P>
Naturally you will need to put <CODE>RewriteEngine on</CODE> in the config prior to these rules, and have <CODE>mod_rewrite</CODE> built into your installation of Apache, for this to work.

<P>
<HR>
<H2><A NAME="IF_YOU_RE_USING_WINDOWS">IF YOU'RE USING WINDOWS</A></H2>
<P>
I tried installing MiG on my laptop running Windows ME and PHPTriad (PHP
&amp; Apache &amp; MySQL all in one bundle). I had all sorts of trouble.

<P>
Pat Moore has reported success using PHPTriad under Windows 98. I don't
know what the difference is, if anything, or perhaps I am simply doing
something grossly wrong on my system.

<P>
So in short, YMMV :-)

</BODY>

</HTML>
