=pod

=head2 Mig - A general purpose photo gallery

Copyright 2000-2002 Daniel M. Lowe

=head2 License Information

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.

A copy of the GPL can be found at http://www.gnu.org/copyleft/gpl.html

=head2 Requirements

Mig requires a web server which supports PHP [ http://www.php.net/ ].
At least PHP 3.0.6 is required, or any version of PHP4.
The development platform is Apple OSX, so the code tends to assume
a unix-like environment.  As such it may or may not work (and has not
been tested by the author) on non-unix-like platforms.  Mig has been tested
with Apache (and reportedly it works with Microsoft's IIS server).

Windows users, please see the section labeled
E<quot>Running Mig Under WindowsE<quot> below.

The F<mkGallery.pl> utility requires Perl [ http://www.perl.com ].  To
generate thumbnail images, it also requires ImageMagick
[ http://www.imagemagick.org/ ].  Neither are required to use Mig itself.

The F<jhead> utility which is called by F<mkGallery.pl> for EXIF header
parsing is a C source code file - it must be compiled before use.  On most
unix-like systems this is as easy as going into the F<jhead> directory and
typing E<quot>makeE<quot>.

Windows users can download the pre-built F<jhead> program from Mathias
Wandel's site at http://www.sentex.net/~mwandel/jhead/

See the E<quot>utilitiesE<quot> document for more information about
F<mkGallery.pl> and F<jhead>.

PHP-Nuke, PostNuke, PHPWebSite and PHPWebThings users:
see the F<phpnuke> document.

=head2 New Installation

Read this section if you are installing Mig for the first time.  If you
are upgrading, skip to the next section which deals with upgrading.

=over 4

=item 1.

Create a directory for Mig to live in, somewhere the web server can read
the files and serve them as web pages.

=item 2.

Copy the file F<index.php> to the new Mig directory.

=item 3.

Copy the file F<config.php.default> to the new Mig directory and call it
F<config.php>.  Any customization of Mig (except layout and colors) can be
done by editing F<config.php>.

=item 4.

Create three subdirectories called F<images>, F<templates> and F<albums>
under the new Mig directory.

=item 5.

Copy the files F<image.gif> and F<no_thumb.gif> from the F<images>
subdirectory to the new F<images> subdirectory.

=item 6.

Copy the files F<image.html>, F<folder.html> and F<style.css> from the
F<templates> subdirectory to the new F<templates> subdirectory.

=item 7.

Put image files (photos, etc) into the F<albums> subdirectory.  You can
make subdirectories to contain different categories of images, and those
subdirectories can contain subdirectories, and so on.  Mig doesn't place
any restriction on how many levels deep subdirectories go.  Arrange the
album any way you wish.  The name of each album is the name of the
directory, so keep that in mind.  For example:

    People
        Family
        Friends
    The_Zoo
        Dolphins
        Bears
        Lions
    Cars

Notice that I used an underline character in B<The_Zoo>.  Mig will display
that as a space, so the album will be called B<The Zoo> as far as visitors
will know.  This makes things simpler since some systems make using
underlines in directory names unfriendly.

The above example ends up being these eight gallery folders:

    People
    People : Family
    People : Friends
    The Zoo
    The Zoo : Dolphins
    The Zoo : Bears
    The Zoo : Lions
    Cars

Mig supports JPEG, GIF and PNG files.  So files with any of these
extensions will be recognized:

    .gif .png .jpg .jpe .jpeg

=item 8.

Point your web browser to the newly-installed Mig and browse away!

=item 9.

If you can run Perl scripts on the commandline on your server, and you have
Perl and ImageMagick available, use F<mkGallery.pl> to create thumbnail
images.  See the F<utilities> document for more information on how.

You should create a F<utilities> subdirectory in your Mig installation and
copy F<mkGallery.pl> there, as well as F<jhead> if you plan to use
F<jhead>.  If Perl is somewhere other than F</usr/bin/perl> on your system
you may need to modify the first line of F<mkGallery.pl> to reflect the
proper location of Perl.

If you can't run Perl scripts, you can make your own thumbnail images in
whatever way is handy for you (an image editing program, for example).
In each album folder, create a subdirectory called F<thumbs>, and put
thumbnail images inside.  A thumbnail should have the same filename as the
full-size image it represents.

The thumbnail subdirectory is F<thumbs> by default, but this can be
customized (see the C<$thumbSubdir> option in F<config.php>).

=back

=head2 Upgrading

If you are upgrading from a previous version of Mig, follow these steps:

=over 4

=item 1.

Copy the F<index.php> file to the Mig directory.  This should replace the
F<index.php> which was already there.  If the existing file was called
F<index.php3>, then the new file should also be called F<index.php3>.

=item 2.

Starting with version 1.3.1, F<mig.cfg> is now called F<config.php>.
If F<mig.cfg> is present, rename it to F<config.php>.  The distribution
comes with F<config.php.default>, which is the new default config file.
F<config.php.default> is just an example.  There is no need to copy it over
to the Mig directory.

=item 3.

Starting with version 1.3.2, the F<funcs.php> and F<lang.php> files are no
longer used.  If they are prsent, delete them.  All code is now contained in
F<index.php>.  Mig will not fail if F<funcs.php> or F<lang.php> are
present, but it's sloppy to leave them laying around.

=item 4.

In version 1.3.5 a lot of changes to the layout system were made.  As a
result, anyone upgrading to 1.3.5 or later (from 1.3.4 or earlier) will
want to use the new template files provided with the Mig distribution.  If
you have customized your template files, don't fret - it should be easy for
you to merge your customizations into the new template files (they're not
very different from the old template files).  Make sure especially to use
the new CSS file.

=item 5.

If you wish to use F<mkGallery.pl>, copy mkGallery.pl from the F<utilities>
directory to the F<utilities> subdirectory of your Mig installation.  You
may need to modify the first line if Perl is somewhere other than
F</usr/bin/perl> on your system.

=item 6.

If you wish to use F<jhead> (note that using the EXIF functions of
F<mkGallery.pl> implies using F<jhead>), you may wish to compile a new copy
of F<jhead> if it's a newer version than you're using now (to find out when
F<jhead> was last updated, check the E<quot>changelogE<quot> document).

If you want F<mkGallery.pl> to be able to use F<jhead>, put F<jhead> in the
F<utilities> subdirectory of your Mig installation with F<mkGallery.pl>.

=back

=head2 Running Mig Under Windows

Mig can run under Windows (so I'm told) as long as the web server supports
PHP.  The Windows version of PHP is available from http://www.php.net/

Mig is reported to work with IIS, Personal Web Server, and the Windows port
of Apache.  One user noted that a fairly recent version of PHP is needed
for it to work, so if you're having trouble, make sure you're using the
most recent release of PHP.

Another user reported that having a comma (,) in the directory name of any
album would cause problems, so avoid using commas.

I've had reports that Windows text editors leave files without trailing end
of line characters, which apparently confuses Mig.  If you're editing files
in a Windows text editor (such as F<mig.cf> files), you may want to leave
one blank line at the end of the file, just so there's at least one end of
line character after the last E<quot>realE<quot> line.

=head2 The Example Gallery

If you want to see an example gallery (that is, install one on your system
and examine the files that it contains), you can download one from the Mig
project page at http://sf.net/projects/mig/ (look in the
E<quot>ExtrasE<quot> section in the project files listing).  After
downloading the file, unpack it in the albums sub directory and it should
appear as E<quot>Mig Example GalleryE<quot>.

=head2 Other people using Mig

You can see a list of sites using Mig at: http://mig.sf.net/users.php

If you'd like to list your site there, email me: at dan@tangledhelix.com

=head2 Optional Customization

=over 4

=item 1. HTML templates (and colors)

Mig is template-based.  Any change to layout or colors can be achieved by
modifying the template files in the F<templates> subdirectory.  See the
F<templates> document for more information.

A per-folder custom template can be used in any given folder.  See the
C<FolderTemplate> section of the F<mig_cf> document for more information.

=item 2. Comments

A comment can be attached to any image.  Comments are stored in a
file called F<mig.cf> in the same directory as the image.  See the
F<mig_cf> document for information about the format of F<mig.cf> files.

Comments are shown in a box below the image in image views.  In
thumbnail views, they are shown as the ALT tag text.  (That behavior can
be suppressed by setting C<$suppressAltTags> to C<TRUE> in F<config.php>).

As an example, let's say you have files F<house.jpg>, F<car.gif> and
F<dog.jpg>.  Let's say you wanted a comment on the house and the dog,
but nothing in particular to say about the car.  Add this to F<mig.cf>:

    <Comment "house.jpg">
    This is my house, which I bought in the fall of 1998.
    </Comment>

    <Comment "dog.jpg">
    This is the dog we had when I was growing up.  She was a lot of
    fun!  Sadly, she died when I was 12 years old (she had cancer).
    We had other dogs afterward, but none of them were as much fun.
    </Comment>

(F<mkGallery.pl> users, see the C<-c> option which handles comments.)

The description can be multiple lines, as long as it's enclosed inside the
E<lt>commentE<gt>...E<lt>/commentE<gt> structure.  Tags such as
E<lt>commentE<gt> must be at the start of a new line.

(If you want to use shorter comments for thumbnail hover-overs and leave
your longer comments only on the image page itself, see the F<mig_cf>
document and read about E<lt>ShortE<gt> tags).

=item 3. EXIF data

Many images contain EXIF header data.  F<mkGallery.pl> can extract this
data using F<jhead>.  See the F<utilities> document for details.

EXIF data generally contains information such as shutter speed, aperture,
ISO rating, the original shooting date and time, and sometimes comments.
Mig can read some, but not all, of this data.  Future versions of Mig may
understand more of the data than it currently does.

By default Mig only shows embedded comments.  To show more, adjust the
format string C<$exifFormatString> found in F<config.php>.  There are
examples in that file that explain how the formatting works.

Note that most graphic editors destroy EXIF blocks!  They don't know how to
write them so when they save images, they are simply not written back into
the file.

=item 4. Item sorting

Items can be sorted in a custom order if desired (rather than relying on
the default alphabetical order).  To do this define a E<lt>sortE<gt> block
in F<mig.cf>.  See the F<mig_cf> document for details.

=item 5. Languages other than English

Mig has support for other languages - however, it only supports those
languages someone has supplied translations for.  If you want to translate
it to another language, please get in touch with me and I'll be glad to add
your translations to the available list of languages.

See F<config.php.default> for more information - Mig now supports English,
French, German, Norwegian, Portugese, Finnish, Romanian, Russian
(Windows-1251 and KOI8-R), Turkish, Swedish, Danish, Italian, Spanish,
Slovak, Dutch, Polish (including an ISO-8859-2 version), Estonian and
Japanese (ISO-2022-JP).

It's also possible to use multiple languages with Mig, although you must
pick one to be the default language - that is the one you define in
F<config.php> in the C<$mig_language> variable.  To change the language,
simply add the parameter C<mig_dl=LANG> to a URL as a parameter.  For
example, take this URL:

    http://mysite.com/gallery/index.php?currDir=./MyStuff

Assuming the default is something else, you can tell Mig to display it in
Spanish by doing this:

    http://mysite.com/gallery/index.php?currDir=./MyStuff&mig_dl=es

To do this at the root of your page (i.e. to have links to your site in
different languages for example) you can do this:

    http://mysite.com/gallery/index.php?mig_dl=no   (Norwegian)

    http://mysite.com/gallery/index.php?mig_dl=fi   (Finnish)

    http://mysite.com/gallery/index.php?mig_dl=ro   (Romanian)

=item 6. Pop-up windows

Pop-up windows can be used (see the C<$imagePopup> option in
F<config.php>).

=item 7. Pagination of large galleries

Sometimes a gallery gets so large, fitting all the thumbnails on one page
becomes a problem (think of a gallery with 500 images).  To resolve this,
Mig paginates large galleries.  By default, any gallery with more than 20
images will go into a paged mode (4 images across, in 5 rows).

This can be controlled using two options in F<config.php>:
C<$maxThumbColumns> and C<$maxThumbRows>.  Their names are
self-explanatory.  Set C<$maxThumbColumns> to the maximum number of columns
desired (how many thumbnails across from left to right in one row).  Set
C<$maxThumbRows> to the maximum number of rows per page/screen.  The
defaults are 4 columns and 5 rows (for 20 images per page).

=item 8. Using random thumbnails instead of folder icons

Instead of using the generic folder icon for folder views, Mig can use a
randomly selected thumbnail from the folder as the icon.  To turn this
behavior on, set C<$randomFolderThumbs> to C<TRUE> in F<config.php>.
(See also C<$folderNameLength> and C<$useRealRandThumbs>.)

If the folder itself contains only other folders, and no images, Mig will
traverse subdirectories until it finds a usable thumbnail to use as an
icon.  So the only time the generic icon will be used is in a situation
where there is a folder that contains no thumbnails, whose subfolders and
their subfolders, etc, contain no thumbnails.  In other words, only a
useless folder branch would result in the generic folder icon being shown.

=item 9. Using a specific thumbnail instead of a folder icon

If you want to use thumbnails as icons, but would rather pick your own
instead of letting Mig pick for you, check out the C<UseThumb> option in
F<mig.cf> files.  See the F<mig_cf> document for more information.

=back

=head2 Common problems

=over 4

=item 1.  Why aren't there any thumbnails?

You have to create thumbnails with F<mkGallery.pl>.  See the document on
F<utilities>.  F<mkGallery.pl> requires Perl and the E<quot>convertE<quot>
program from ImageMagick.

If you can't do it that way, don't despair - you can make your own
thumbnails in any image editing program.  Earlier in this document are
instructions on how to name the files and where to put them.

=item 2.  I am getting a bunch of errors in my browser!

You (or your web server admin) probably have C<error_reporting> set
incorrectly in the PHP configuration in your web server.  Put this line
near the top of F<index.php> (but not before the E<quot>E<lt>?phpE<quot>
line at the top).

    error_reporting (E_ALL & ~E_NOTICE);    // for PHP3 systems

    error_reporting (2039);                 // for PHP4 systems

=back

=head2 Bug Reporting

To report a bug, or view existing bug reports, go to:

    http://sourceforge.net/tracker/?group_id=24365

=head2 Feature Requests

To request a feature, or view existing feature requests, go to:

    http://sourceforge.net/tracker/?group_id=24365

=head2 Email Lists

=over 4

=item 1. mig-announce

mig-announce is an announcements-only list.  Generally speaking that
means the only traffic it gets are announcements of new versions posted
by the author.

    http://lists.sourceforge.net/lists/listinfo/mig-announce

=item 2. mig-users

mig-users is a general discussion list.  Any Mig-related topic can be
discussed on this list.

    http://lists.sourceforge.net/lists/listinfo/mig-users

=item 3. mig-devel

mig-devel is for people interested in development work related to Mig.

    http://lists.sourceforge.net/lists/listinfo/mig-devel

=back

=cut

